---
import { getAllTechnologies } from '../../data/projects';

interface Props {
  selectedTag: string | null;
  lang?: string;
}

const { selectedTag, lang = 'es' } = Astro.props;
const allTechnologies = getAllTechnologies();
---

<div class="flex flex-wrap gap-2 mb-8">
  <!-- Botón "Todos" -->
  <button
    data-filter="all"
    class={`px-4 py-2 rounded-full text-sm font-semibold transition-all ${
      selectedTag === null
        ? 'bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/50'
        : 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 border-2 border-gray-300 dark:border-gray-600'
    }`}
  >
    Todos
  </button>

  <!-- Botones de tecnologías -->
  {allTechnologies.map((tech) => (
    <button
      data-filter={tech}
      class={`px-4 py-2 rounded-full text-sm font-semibold transition-all ${
        selectedTag === tech
          ? 'bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/50'
          : 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 border-2 border-gray-300 dark:border-gray-600'
      }`}
    >
      {tech}
    </button>
  ))}
</div>

<script>
  // Filtrado de proyectos por tecnología
  document.addEventListener('DOMContentLoaded', () => {
    const filterButtons = document.querySelectorAll('[data-filter]');
    const projectCards = document.querySelectorAll('[data-project-card]');

    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const filter = button.getAttribute('data-filter');
        
        // Actualizar estado activo
        filterButtons.forEach(btn => {
          btn.classList.remove('bg-gradient-to-r', 'from-cyan-500', 'to-blue-500', 'text-white', 'shadow-lg', 'shadow-cyan-500/50');
          btn.classList.add('bg-gray-100', 'dark:bg-gray-800', 'text-gray-700', 'dark:text-gray-300');
        });
        
        button.classList.remove('bg-gray-100', 'dark:bg-gray-800', 'text-gray-700', 'dark:text-gray-300');
        button.classList.add('bg-gradient-to-r', 'from-cyan-500', 'to-blue-500', 'text-white', 'shadow-lg', 'shadow-cyan-500/50');

        // Filtrar proyectos
        projectCards.forEach(card => {
          const cardTechs = card.getAttribute('data-technologies')?.split(',') || [];
          
          if (filter === 'all' || cardTechs.includes(filter)) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
      });
    });
  });
</script>
